<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ë‚˜ë§Œì˜ ê°•ì•„ì§€ í‚¤ìš°ê¸° ğŸ¾</title>
  <style>
    @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
    body {
      margin: 0;
      font-family: 'Pretendard', 'Malgun Gothic', sans-serif;
      background-color: #fefae0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1 {
      margin: 20px;
      font-size: 2.4rem;
      color: #d4a373;
    }
    .screen {
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    .active {
      display: flex !important;
    }
    .button {
      padding: 12px 24px;
      margin: 10px;
      font-size: 1.1rem;
      background: #f9dcc4;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .button:hover {
      background: #fcd5b5;
    }
    input {
      padding: 10px;
      font-size: 1rem;
      border-radius: 8px;
      border: 1px solid #ccc;
      margin-top: 10px;
      width: 200px;
    }
    #game-wrapper {
      width: 95%;
      max-width: 860px;
      aspect-ratio: 4 / 3;
      position: relative;
      background: #ffffff;
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 10px 25px rgba(0,0,0,0.1);
      margin-top: 20px;
    }
    canvas {
      width: 100%;
      height: 100%;
      display: block;
    }
    .status-bar, .event-timer, .celebrate, .interaction-toggle, .interaction-panel {
      position: absolute;
      z-index: 10;
    }
    .status-bar {
      top: 10px;
      left: 10px;
      background: rgba(255, 255, 255, 0.95);
      padding: 10px 15px;
      border-radius: 12px;
      font-size: 0.95rem;
      line-height: 1.5;
      border: 1px solid #f4d6a3;
    }
    .event-timer {
      top: 10px;
      right: 10px;
      background: rgba(255, 250, 200, 0.95);
      padding: 10px 15px;
      border-radius: 12px;
      font-size: 0.95rem;
      color: #c26900;
      border: 1px dashed #e2a849;
    }
    .celebrate {
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 2.2rem;
      background: #fff3cd;
      color: #d9480f;
      padding: 15px 25px;
      border: 2px solid #ffd6a5;
      border-radius: 20px;
      box-shadow: 0 5px 10px rgba(0,0,0,0.1);
      display: none;
      animation: fadeIn 1s ease-in-out;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translate(-50%, -60%); }
      to { opacity: 1; transform: translate(-50%, -50%); }
    }
    .interaction-toggle {
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
    }
    .interaction-panel {
      bottom: 60px;
      left: 50%;
      transform: translateX(-50%);
      display: none;
      flex-direction: row;
      gap: 10px;
    }
    .interaction-panel .button {
      background: #d2f4dc;
    }
    .album-screen {
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    .album-screen h2 {
      font-size: 1.8rem;
      color: #8c6b4f;
      margin-bottom: 20px;
    }
    .album-images {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
    }
    .album-images img {
      width: 120px;
      height: 120px;
      border-radius: 10px;
      object-fit: cover;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>
  <h1>ë‚˜ë§Œì˜ ê°•ì•„ì§€ í‚¤ìš°ê¸° ğŸ¶</h1>

  <audio id="bgm" autoplay loop>
    <source src="https://dessa1995.github.io/dessa/bgm.mp3" type="audio/mp3">
  </audio>

  <!-- ì‹œì‘ í™”ë©´ -->
  <div id="start-screen" class="screen active">
    <button class="button" onclick="showBreedSelection()">ê²Œì„ ì‹œì‘</button>
  </div>

  <!-- í’ˆì¢… ì„ íƒ í™”ë©´ -->
  <div id="breed-screen" class="screen">
    <h2>ê°•ì•„ì§€ í’ˆì¢…ì„ ì„ íƒí•˜ì„¸ìš”</h2>
    <button class="button" onclick="selectBreed('golden')">ê³¨ë“  ë¦¬íŠ¸ë¦¬ë²„</button>
    <button class="button" onclick="selectBreed('bichon')">ë¹„ìˆ‘ í”„ë¦¬ì œ</button>
  </div>

  <!-- ì´ë¦„ ì„¤ì • í™”ë©´ -->
  <div id="name-screen" class="screen">
    <h2>ê°•ì•„ì§€ ì´ë¦„ì„ ì§€ì–´ì£¼ì„¸ìš”</h2>
    <input type="text" id="dog-name" placeholder="ì´ë¦„ ì…ë ¥" />
    <button class="button" onclick="startGame()">ì‹œì‘!</button>
  </div>

  <!-- ê²Œì„ í™”ë©´ -->
  <div id="game-screen" class="screen">
    <div id="game-wrapper">
      <canvas id="gameCanvas" width="800" height="600"></canvas>

      <div class="status-bar" id="status">
        ì´ë¦„: <span id="status-name">?</span><br>
        ë‚˜ì´: <span id="status-age">0</span>ì„¸<br>
        ì„±ì¥ê¸°: <span id="status-stage">ì‹ ìƒì•„ê¸°</span><br>
        ì¹œë°€ë„: <span id="status-bond">50</span><br>
        ë°°ê³ í””: <span id="status-hungry">50</span>
      </div>

      <div class="event-timer">
        ë‹¤ìŒ ì´ë²¤íŠ¸ê¹Œì§€: <span id="event-timer">5</span>ì´ˆ
      </div>

      <div class="celebrate" id="celebrate-box">ğŸ‰ ì„±ì¥í–ˆì–´ìš”! ğŸ‰<br><button onclick="continueAfterCelebrate()">ì¶•í•˜í•´</button></div>

      <div class="interaction-toggle">
        <button class="button" onclick="toggleInteraction()">ìƒí˜¸ì‘ìš© ë³´ê¸°</button>
      </div>

      <div class="interaction-panel" id="interaction-panel">
        <button class="button" onclick="interact('ear')">ê·€ ëƒ„ìƒˆ ë§¡ê¸°</button>
        <button class="button" onclick="interact('paw')">ë°œ ëƒ„ìƒˆ ë§¡ê¸°</button>
        <button class="button" onclick="interact('hug')">ê»´ì•ˆê¸°</button>
        <button class="button" onclick="interact('pet')">ì“°ë‹¤ë“¬ê¸°</button>
      </div>
    </div>
  </div>
  <!-- ì¶”ì–µ íšŒìƒ ì•¨ë²” í™”ë©´ -->
  <div id="album-screen" class="screen">
    <h2 id="album-message"></h2>
    <div id="album-images" style="display:flex; gap:10px; flex-wrap:wrap; justify-content:center;"></div>
    <button class="button" onclick="location.reload()">ë‹¤ì‹œ ì‹œì‘í•˜ê¸°</button>
  </div>

  <script>
    let breed = '';
    let name = '';
    let age = 0;
    let bond = 50;
    let hunger = 50;
    let stage = 'ì‹ ìƒì•„ê¸°';
    let nextEventTime = 5;
    let imageList = [];
    let gameInterval, ageInterval;
    let eventPaused = false;
    let dogImage = new Image();

    function showBreedSelection() {
      document.getElementById('start-screen').classList.remove('active');
      document.getElementById('breed-screen').classList.add('active');
    }

    function selectBreed(selected) {
      breed = selected;
      document.getElementById('breed-screen').classList.remove('active');
      document.getElementById('name-screen').classList.add('active');
    }

    function startGame() {
      name = document.getElementById('dog-name').value || 'ë©ë©ì´';
      document.getElementById('name-screen').classList.remove('active');
      document.getElementById('game-screen').classList.add('active');
      document.getElementById('status-name').innerText = name;

      dogImage.onload = () => {
        drawGame();
      };
      setDogImage();
      gameInterval = setInterval(updateEventTimer, 1000);
      ageInterval = setInterval(increaseAge, 20000);
    }

    function setDogImage() {
      let index = (age < 2) ? 1 : (age < 6) ? 2 : (age < 10) ? 3 : 4;
      const src = `https://dessa1995.github.io/dessa/${breed === 'golden' ? 'g' : 'b'}${index}.png`;
      dogImage.src = src;
    }

    function drawGame() {
      const ctx = document.getElementById('gameCanvas').getContext('2d');
      ctx.clearRect(0, 0, 800, 600);
      ctx.drawImage(dogImage, 250, 150, 300, 300);
    }

    function updateStatus() {
      document.getElementById('status-age').innerText = age;
      document.getElementById('status-stage').innerText = stage;
      document.getElementById('status-bond').innerText = bond;
      document.getElementById('status-hungry').innerText = hunger;
    }

    function toggleInteraction() {
      const panel = document.getElementById('interaction-panel');
      panel.style.display = panel.style.display === 'flex' ? 'none' : 'flex';
    }

    function interact(type) {
      bond = Math.min(100, bond + 5);
      hunger = Math.max(0, hunger - 5);
      updateStatus();
    }

    function continueAfterCelebrate() {
      document.getElementById('celebrate-box').style.display = 'none';
      eventPaused = false;
    }

    function increaseAge() {
      if (eventPaused) return;
      age++;
      if (age === 2) stage = 'ì²­ì†Œë…„ê¸°';
      else if (age === 6) stage = 'ì„±ê²¬ê¸°';
      else if (age === 10) stage = 'ë…¸ë ¹ê¸°';
      updateStatus();
      setDogImage();
      drawGame();
      showCelebrate();
      imageList.push(dogImage.src);
      if (age === 10) {
        setTimeout(showAlbum, 60000); // ë…¸ë ¹ê¸° í›„ 1ë¶„
      }
    }

    function showCelebrate() {
      document.getElementById('celebrate-box').style.display = 'block';
      eventPaused = true;
    }

    function showAlbum() {
      clearInterval(gameInterval);
      clearInterval(ageInterval);
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById('album-screen').classList.add('active');
      document.getElementById('album-message').innerText = `${name}ì´ê°€ ì˜ˆì˜ê³  ë©‹ì§€ê²Œ ìëì–´ìš”!`;
      const container = document.getElementById('album-images');
      container.innerHTML = '';
      imageList.forEach(src => {
        const img = document.createElement('img');
        img.src = src;
        img.style.width = '120px';
        img.style.borderRadius = '10px';
        container.appendChild(img);
      });
    }

    function updateEventTimer() {
      if (eventPaused) return;
      nextEventTime--;
      document.getElementById('event-timer').innerText = nextEventTime;
      if (nextEventTime <= 0) {
        triggerRandomEvent();
        nextEventTime = 5;
      }
    }

    const events = [
      'ì‚°ì±… ê°€ìê³  ì¡¸ë¼ìš”!',
      'ê°„ì‹ì„ ë‹¬ë¼ê³  í•´ìš”!',
      'ì¥ë‚œê°ì„ ë¬¼ì–´ì™”ì–´ìš”!',
      'ë¬¸ ì•ì—ì„œ ê¼¬ë¦¬ë¥¼ í”ë“¤ì–´ìš”!',
      'ë©ë© ì§–ì–´ìš”!',
      'ë°°ë¥¼ ë³´ì—¬ì¤˜ìš”!',
      'ê¼¬ë¦¬ë¥¼ í”ë“¤ë©° ë‹¬ë ¤ì™€ìš”!',
      'ìŠ¬ì© ê¸°ëŒ€ìš”!',
      'í‚í‚ ëƒ„ìƒˆ ë§¡ì•„ìš”!',
      'ë°œì„ ì‚´ì§ ì˜¬ë ¤ìš”!'
    ];

    function triggerRandomEvent() {
      const text = events[Math.floor(Math.random() * events.length)];
      alert(`[ì´ë²¤íŠ¸] ${name}ì´ê°€ ${text}`);
    }
  </script>
</body>
</html>
