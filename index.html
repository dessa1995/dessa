<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ê°•ì•„ì§€ í‚¤ìš°ê¸° ê²Œì„</title>
  <link rel="icon" href="data:,">
  <style>
    @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');

    body {
      margin: 0;
      font-family: 'Pretendard', 'Malgun Gothic', sans-serif;
      background-color: #fefae0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
    }

    h1 {
      margin: 20px;
      font-size: 2.5rem;
      color: #d4a373;
    }

    #game-wrapper {
      width: 95%;
      max-width: 900px;
      position: relative;
      background: #ffffff;
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 10px 25px rgba(0,0,0,0.15);
      border: 10px solid #ffffff;
      padding: 20px;
      text-align: center;
    }

    .status-bar {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      font-size: 1rem;
      padding: 8px 12px;
      background-color: #f0ebe3;
      border-radius: 12px;
      margin-bottom: 10px;
    }

    .status-item {
      flex: 1 1 45%;
      margin: 5px 0;
    }

    #main-screen, #event-box, #interaction-box, #end-screen {
      display: none;
    }

    #puppyImage {
      width: 250px;
      height: auto;
      border-radius: 12px;
      margin: 10px 0;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    #setup-screen input, #setup-screen select {
      padding: 10px;
      font-size: 1rem;
      border-radius: 8px;
      border: 1px solid #ccc;
      margin-bottom: 10px;
      width: 80%;
    }

    #setup-screen button {
      padding: 10px 20px;
      font-size: 1.1rem;
      background-color: #d4a373;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    #event-box {
      padding: 15px;
      background-color: #fff3cd;
      border: 1px solid #ffeeba;
      border-radius: 10px;
      margin-top: 15px;
    }

    #event-text {
      font-size: 1.2rem;
      margin-bottom: 12px;
    }

    #event-choices button {
      padding: 8px 16px;
      margin: 4px;
      font-size: 1rem;
      border: none;
      border-radius: 8px;
      background-color: #d4a373;
      color: white;
      cursor: pointer;
    }

    #interaction-box {
      margin-top: 15px;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 8px;
    }

    .interaction-btn {
      padding: 8px 16px;
      border-radius: 6px;
      background-color: #a3c4f3;
      border: none;
      cursor: pointer;
      font-size: 0.95rem;
    }

    @keyframes fadeout {
      0% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
      100% { opacity: 0; transform: translate(-50%, -100%) scale(1.5); }
    }

    @keyframes pop {
      0% { transform: translate(-50%, -50%) scale(0.2); opacity: 0.2; }
      50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
      100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
    }

    #album {
      display: none;
      text-align: center;
      margin-top: 30px;
    }

    #album h2 {
      color: #a0522d;
    }

    #album-img {
      width: 220px;
      border-radius: 12px;
      border: 3px solid #d4a373;
      margin-top: 10px;
    }

    #restartBtn {
      margin-top: 20px;
      padding: 10px 18px;
      background-color: #faedcd;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-size: 1rem;
    }

    #restartBtn:hover {
      background-color: #f9db9b;
    }
  </style>
</head>
<body>
  <h1>ğŸ¾ ë‚˜ë§Œì˜ ê°•ì•„ì§€ í‚¤ìš°ê¸° ğŸ¾</h1>
  <div id="game-wrapper">
    <div id="setup-screen">
      <p>ê°•ì•„ì§€ í’ˆì¢…ì„ ê³¨ë¼ì£¼ì„¸ìš”:</p>
      <select id="breed">
        <option>ê³¨ë“  ë¦¬íŠ¸ë¦¬ë²„</option>
        <option>ë¹„ìˆ‘ í”„ë¦¬ì œ</option>
      </select><br />
      <p>ê°•ì•„ì§€ ì´ë¦„ì„ ì§€ì–´ì£¼ì„¸ìš”:</p>
      <input type="text" id="puppyName" placeholder="ì˜ˆ: ë½€ì‚" /><br />
      <button onclick="startGame()">ê²Œì„ ì‹œì‘!</button>
    </div>
    <div id="main-screen">
      <div class="status-bar">
        <div class="status-item">ë‚˜ì´: <span id="age">0</span>ì‚´</div>
        <div class="status-item">ì¹œë°€ë„: <span id="bond">50</span></div>
        <div class="status-item">ë°°ê³ í””: <span id="hunger">50</span></div>
        <div class="status-item">ë‹¤ìŒ ì´ë²¤íŠ¸ê¹Œì§€: <span id="event-timer">5</span>ì´ˆ</div>
      </div>

      <img id="puppyImage" src="" alt="ê·€ì—¬ìš´ ê°•ì•„ì§€" />

      <div id="event-box">
        <div id="event-text">ì´ë²¤íŠ¸ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</div>
        <div id="event-choices"></div>
      </div>

      <div id="interaction-box">
        <button class="interaction-btn" onclick="interact('ê·€ ëƒ„ìƒˆ ë§¡ê¸°')">ê·€ ëƒ„ìƒˆ ë§¡ê¸°</button>
        <button class="interaction-btn" onclick="interact('ë°œ ëƒ„ìƒˆ ë§¡ê¸°')">ë°œ ëƒ„ìƒˆ ë§¡ê¸°</button>
        <button class="interaction-btn" onclick="interact('ê»´ì•ˆê¸°')">ê»´ì•ˆê¸°</button>
        <button class="interaction-btn" onclick="interact('ì“°ë‹¤ë“¬ê¸°')">ì“°ë‹¤ë“¬ê¸°</button>
      </div>
    </div>

    <div id="end-screen" style="display:none;">
      <h2>ğŸ‰ ì¶”ì–µ ì•¨ë²” ğŸ‰</h2>
      <p id="final-message">OOì´ê°€ ì˜ˆì˜ê³  ë©‹ì§€ê²Œ ìëì–´ìš”!</p>
      <img id="albumImage" src="" style="width:200px; border-radius:12px;" />
      <br /><br />
      <button onclick="location.reload()">ë‹¤ì‹œ ì‹œì‘í•˜ê¸°</button>
    </div>
  </div>

  <audio id="bgm" loop>
    <source src="https://dessa1995.github.io/dessa/bgm.mp3" type="audio/mp3" />
  </audio>
  <script>
    let puppy = {
      name: '',
      breed: '',
      age: 0,
      bond: 50,
      hunger: 50
    };

    let ageTimer, eventTimer, eventCountdown = 5;
    let isGrowing = false;

    function startGame() {
      const name = document.getElementById("puppyName").value.trim();
      const breed = document.getElementById("breed").value;
      if (!name) return alert("ê°•ì•„ì§€ ì´ë¦„ì„ ì§€ì–´ì£¼ì„¸ìš”!");

      puppy.name = name;
      puppy.breed = breed;

      document.getElementById("setup-screen").style.display = "none";
      document.getElementById("main-screen").style.display = "block";
      document.getElementById("bgm").play();

      updateUI();
      startTimers();
    }

    function startTimers() {
      ageTimer = setInterval(() => {
        puppy.age++;
        if (puppy.age === 10) {
          setTimeout(endGame, 60000); // ë…¸ë ¹ê¸° ì´í›„ 1ë¶„ í›„ ì¢…ë£Œ
        }
        checkGrowth();
        updateUI();
      }, 20000); // 20ì´ˆë§ˆë‹¤ ë‚˜ì´ ì¦ê°€

      eventTimer = setInterval(() => {
        if (!isGrowing) triggerEvent();
      }, 5000); // 5ì´ˆë§ˆë‹¤ ì´ë²¤íŠ¸

      setInterval(() => {
        if (eventCountdown > 0) {
          eventCountdown--;
        } else {
          eventCountdown = 5;
        }
        document.getElementById("event-timer").innerText = eventCountdown;
      }, 1000);
    }

    function updateUI() {
      document.getElementById("age").innerText = puppy.age;
      document.getElementById("bond").innerText = puppy.bond;
      document.getElementById("hunger").innerText = puppy.hunger;

      let stage = 1;
      if (puppy.age >= 2 && puppy.age < 6) stage = 2;
      else if (puppy.age >= 6 && puppy.age < 10) stage = 3;
      else if (puppy.age >= 10) stage = 4;

      const imgBase = puppy.breed === "ê³¨ë“  ë¦¬íŠ¸ë¦¬ë²„" ? "g" : "b";
      document.getElementById("puppyImage").src = `https://dessa1995.github.io/dessa/${imgBase}${stage}.png`;
    }

    function checkGrowth() {
      if (puppy.age === 2 || puppy.age === 6 || puppy.age === 10) {
        isGrowing = true;
        const eff = document.createElement("div");
        eff.innerText = "ğŸ‰ ì„±ì¥í–ˆì–´ìš”!";
        eff.style.position = "absolute";
        eff.style.top = "50%";
        eff.style.left = "50%";
        eff.style.transform = "translate(-50%, -50%)";
        eff.style.fontSize = "2rem";
        eff.style.backgroundColor = "#fcd5ce";
        eff.style.padding = "10px";
        eff.style.borderRadius = "12px";
        eff.style.zIndex = "99";
        document.getElementById("game-wrapper").appendChild(eff);

        setTimeout(() => {
          eff.remove();
          isGrowing = false;
        }, 2000);
      }
    }
    function toggleInteraction() {
      const box = document.getElementById("interaction-box");
      box.style.display = (box.style.display === "none") ? "flex" : "none";
    }

    function interact(action) {
      const reactions = {
        "ê·€ ëƒ„ìƒˆ ë§¡ê¸°": "ğŸ˜Š í‚í‚! ì¢‹ì•„í•˜ëŠ” ëƒ„ìƒˆì•¼!",
        "ë°œ ëƒ„ìƒˆ ë§¡ê¸°": "ğŸ˜† ìš°ì™€~ ê°„ì§ˆê°„ì§ˆí•´!",
        "ê»´ì•ˆê¸°": "ğŸ’– ë”°ëœ»í•´ì„œ ì¢‹ì•„!",
        "ì“°ë‹¤ë“¬ê¸°": "ğŸ¥° ê¸°ë¶„ ìµœê³ ì•¼!"
      };

      showFloatingReaction(reactions[action] || "ì¢‹ì•„!");
      puppy.bond = Math.min(puppy.bond + 3, 100);
      puppy.hunger = Math.max(puppy.hunger - 2, 0);
      updateUI();
    }

    function showFloatingReaction(text) {
      const eff = document.createElement("div");
      eff.innerText = text;
      eff.style.position = "absolute";
      eff.style.top = "55%";
      eff.style.left = "50%";
      eff.style.transform = "translate(-50%, -50%)";
      eff.style.fontSize = "1.5rem";
      eff.style.padding = "8px 14px";
      eff.style.borderRadius = "10px";
      eff.style.background = "#fff4bd";
      eff.style.border = "1px solid #f0d586";
      eff.style.zIndex = "100";
      eff.style.animation = "fadeout 2s forwards";

      document.getElementById("game-wrapper").appendChild(eff);
      setTimeout(() => eff.remove(), 2000);
    }

    function triggerEvent() {
      const events = [
        { text: `${puppy.name}ê°€ ë°°ê³ íŒŒí•´ìš”`, choices: ["ê°„ì‹ ì£¼ê¸°", "ë¬´ì‹œí•˜ê¸°"], effects: [+2, -3] },
        { text: `${puppy.name}ê°€ ì‹¬ì‹¬í•´í•´ìš”`, choices: ["ë†€ì•„ì£¼ê¸°", "ë¬´ì‹œí•˜ê¸°"], effects: [+3, -2] },
        { text: `${puppy.name}ê°€ ì¡¸ë ¤ í•´ìš”`, choices: ["ì¬ì›Œì£¼ê¸°", "ê¹¨ìš°ê¸°"], effects: [+1, -1] },
        { text: `${puppy.name}ê°€ ëˆˆì„ ë°˜ì§ì´ë©° ì³ë‹¤ë´ìš”`, choices: ["ì“°ë‹¤ë“¬ê¸°", "ë¬´ì‹œí•˜ê¸°"], effects: [+2, -2] },
        { text: `${puppy.name}ê°€ ì§–ê³  ìˆì–´ìš”`, choices: ["ë‹¬ë˜ê¸°", "í˜¼ë‚´ê¸°"], effects: [+1, -1] },
        { text: `${puppy.name}ê°€ í˜¼ì ìˆì–´ì„œ ì™¸ë¡œì›Œí•´ìš”`, choices: ["ê»´ì•ˆê¸°", "ë¬´ì‹œí•˜ê¸°"], effects: [+2, -3] },
        { text: `${puppy.name}ê°€ ë°©ì„ ì–´ì§ˆë €ì–´ìš”`, choices: ["í˜¼ë‚´ê¸°", "ì°¸ê¸°"], effects: [-1, +1] },
        { text: `${puppy.name}ê°€ ì•„íŒŒë³´ì—¬ìš”`, choices: ["ë³‘ì›ê°€ê¸°", "ì§€ì¼œë³´ê¸°"], effects: [+3, -2] },
        { text: `${puppy.name}ê°€ ë•…ë°”ë‹¥ì— ë“œëŸ¬ëˆ„ì› ì–´ìš”`, choices: ["ê°„ì‹ì£¼ê¸°", "ê·¸ëƒ¥ë‘ "], effects: [+1, -2] },
        { text: `${puppy.name}ê°€ ì¥ë‚œê°ì„ ì°¾ì•˜ì–´ìš”`, choices: ["ê°™ì´ ë†€ê¸°", "ë¬´ì‹œí•˜ê¸°"], effects: [+3, -1] }
      ];

      const selected = events[Math.floor(Math.random() * events.length)];
      document.getElementById("event-box").style.display = "block";
      document.getElementById("event-text").innerText = selected.text;

      const choiceBox = document.getElementById("event-choices");
      choiceBox.innerHTML = "";

      selected.choices.forEach((choice, i) => {
        const btn = document.createElement("button");
        btn.innerText = choice;
        btn.onclick = () => {
          puppy.bond = Math.min(puppy.bond + selected.effects[i], 100);
          puppy.hunger = Math.min(puppy.hunger + (i === 0 ? -1 : +1), 100);
          updateUI();
          document.getElementById("event-box").style.display = "none";
        };
        choiceBox.appendChild(btn);
      });
    }

    function showConfetti() {
      const confetti = document.createElement("div");
      confetti.innerText = "ğŸ‰";
      confetti.style.position = "absolute";
      confetti.style.top = "30%";
      confetti.style.left = "50%";
      confetti.style.fontSize = "4rem";
      confetti.style.transform = "translate(-50%, -50%) scale(1)";
      confetti.style.animation = "pop 1.5s ease-out forwards";

      document.getElementById("game-wrapper").appendChild(confetti);
      setTimeout(() => confetti.remove(), 1500);
    }
    function showAlbum() {
      document.getElementById("album").style.display = "block";
      document.getElementById("album-name").innerText = `${puppy.name}ì˜ ì¶”ì–µ ì•¨ë²”`;
      const imgStage = puppy.age < 2 ? 1 : puppy.age < 6 ? 2 : puppy.age < 10 ? 3 : 4;
      const imgBase = puppy.breed === "ê³¨ë“  ë¦¬íŠ¸ë¦¬ë²„" ? "g" : "b";
      document.getElementById("album-img").src = `https://dessa1995.github.io/dessa/${imgBase}${imgStage}.png`;

      document.getElementById("game-wrapper").style.display = "none";
    }

    function endGame() {
      clearInterval(ageTimer);
      clearInterval(eventTimer);
      setTimeout(showAlbum, 3000);
    }

    document.getElementById("restartBtn").onclick = () => {
      location.reload();
    };

    window.onload = () => {
      document.getElementById("interaction-toggle").addEventListener("click", toggleInteraction);
      document.getElementById("interaction-box").style.display = "none";
    };
  </script>

  <style>
    @keyframes fadeout {
      0% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
      100% { opacity: 0; transform: translate(-50%, -100%) scale(1.5); }
    }

    @keyframes pop {
      0% { transform: translate(-50%, -50%) scale(0.2); opacity: 0.2; }
      50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
      100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
    }

    #album {
      display: none;
      text-align: center;
      margin-top: 30px;
    }

    #album h2 {
      color: #a0522d;
    }

    #album-img {
      width: 220px;
      border-radius: 12px;
      border: 3px solid #d4a373;
      margin-top: 10px;
    }

    #restartBtn {
      margin-top: 20px;
      padding: 10px 18px;
      background-color: #faedcd;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-size: 1rem;
    }

    #restartBtn:hover {
      background-color: #f9db9b;
    }
  </style>

  <div id="album">
    <h2 id="album-name"></h2>
    <img id="album-img" src="" alt="ì¶”ì–µ ì´ë¯¸ì§€" />
    <br />
    <button id="restartBtn">ë‹¤ì‹œ ì‹œì‘í•˜ê¸°</button>
  </div>
</body>
</html>
