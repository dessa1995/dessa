<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>강아지 키우기 게임</title>
  <link rel="icon" href="data:,">
  <style>
    @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');

    body {
      margin: 0;
      font-family: 'Pretendard', 'Malgun Gothic', sans-serif;
      background-color: #fefae0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
    }

    h1 {
      margin: 20px;
      font-size: 2.5rem;
      color: #d4a373;
    }

    #game-wrapper {
      width: 95%;
      max-width: 900px;
      position: relative;
      background: #ffffff;
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 10px 25px rgba(0,0,0,0.15);
      border: 10px solid #ffffff;
      padding: 20px;
      text-align: center;
    }

    .status-bar {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      font-size: 1rem;
      padding: 8px 12px;
      background-color: #f0ebe3;
      border-radius: 12px;
      margin-bottom: 10px;
    }

    .status-item {
      flex: 1 1 45%;
      margin: 5px 0;
    }

    #main-screen, #event-box, #interaction-box, #end-screen {
      display: none;
    }

    #puppyImage {
      width: 250px;
      height: auto;
      border-radius: 12px;
      margin: 10px 0;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    #setup-screen input, #setup-screen select {
      padding: 10px;
      font-size: 1rem;
      border-radius: 8px;
      border: 1px solid #ccc;
      margin-bottom: 10px;
      width: 80%;
    }

    #setup-screen button {
      padding: 10px 20px;
      font-size: 1.1rem;
      background-color: #d4a373;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    #event-box {
      padding: 15px;
      background-color: #fff3cd;
      border: 1px solid #ffeeba;
      border-radius: 10px;
      margin-top: 15px;
    }

    #event-text {
      font-size: 1.2rem;
      margin-bottom: 12px;
    }

    #event-choices button {
      padding: 8px 16px;
      margin: 4px;
      font-size: 1rem;
      border: none;
      border-radius: 8px;
      background-color: #d4a373;
      color: white;
      cursor: pointer;
    }

    #interaction-box {
      margin-top: 15px;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 8px;
    }

    .interaction-btn {
      padding: 8px 16px;
      border-radius: 6px;
      background-color: #a3c4f3;
      border: none;
      cursor: pointer;
      font-size: 0.95rem;
    }

    @keyframes fadeout {
      0% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
      100% { opacity: 0; transform: translate(-50%, -100%) scale(1.5); }
    }

    @keyframes pop {
      0% { transform: translate(-50%, -50%) scale(0.2); opacity: 0.2; }
      50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
      100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
    }

    #album {
      display: none;
      text-align: center;
      margin-top: 30px;
    }

    #album h2 {
      color: #a0522d;
    }

    #album-img {
      width: 220px;
      border-radius: 12px;
      border: 3px solid #d4a373;
      margin-top: 10px;
    }

    #restartBtn {
      margin-top: 20px;
      padding: 10px 18px;
      background-color: #faedcd;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-size: 1rem;
    }

    #restartBtn:hover {
      background-color: #f9db9b;
    }
  </style>
</head>
<body>
  <h1>🐾 나만의 강아지 키우기 🐾</h1>
  <div id="game-wrapper">
    <div id="setup-screen">
      <p>강아지 품종을 골라주세요:</p>
      <select id="breed">
        <option>골든 리트리버</option>
        <option>비숑 프리제</option>
      </select><br />
      <p>강아지 이름을 지어주세요:</p>
      <input type="text" id="puppyName" placeholder="예: 뽀삐" /><br />
      <button onclick="startGame()">게임 시작!</button>
    </div>
    <div id="main-screen">
      <div class="status-bar">
        <div class="status-item">나이: <span id="age">0</span>살</div>
        <div class="status-item">친밀도: <span id="bond">50</span></div>
        <div class="status-item">배고픔: <span id="hunger">50</span></div>
        <div class="status-item">다음 이벤트까지: <span id="event-timer">5</span>초</div>
      </div>

      <img id="puppyImage" src="" alt="귀여운 강아지" />

      <div id="event-box">
        <div id="event-text">이벤트 내용이 여기에 표시됩니다</div>
        <div id="event-choices"></div>
      </div>

      <div id="interaction-box">
        <button class="interaction-btn" onclick="interact('귀 냄새 맡기')">귀 냄새 맡기</button>
        <button class="interaction-btn" onclick="interact('발 냄새 맡기')">발 냄새 맡기</button>
        <button class="interaction-btn" onclick="interact('껴안기')">껴안기</button>
        <button class="interaction-btn" onclick="interact('쓰다듬기')">쓰다듬기</button>
      </div>
    </div>

    <div id="end-screen" style="display:none;">
      <h2>🎉 추억 앨범 🎉</h2>
      <p id="final-message">OO이가 예쁘고 멋지게 자랐어요!</p>
      <img id="albumImage" src="" style="width:200px; border-radius:12px;" />
      <br /><br />
      <button onclick="location.reload()">다시 시작하기</button>
    </div>
  </div>

  <audio id="bgm" loop>
    <source src="https://dessa1995.github.io/dessa/bgm.mp3" type="audio/mp3" />
  </audio>
  <script>
    let puppy = {
      name: '',
      breed: '',
      age: 0,
      bond: 50,
      hunger: 50
    };

    let ageTimer, eventTimer, eventCountdown = 5;
    let isGrowing = false;

    function startGame() {
      const name = document.getElementById("puppyName").value.trim();
      const breed = document.getElementById("breed").value;
      if (!name) return alert("강아지 이름을 지어주세요!");

      puppy.name = name;
      puppy.breed = breed;

      document.getElementById("setup-screen").style.display = "none";
      document.getElementById("main-screen").style.display = "block";
      document.getElementById("bgm").play();

      updateUI();
      startTimers();
    }

    function startTimers() {
      ageTimer = setInterval(() => {
        puppy.age++;
        if (puppy.age === 10) {
          setTimeout(endGame, 60000); // 노령기 이후 1분 후 종료
        }
        checkGrowth();
        updateUI();
      }, 20000); // 20초마다 나이 증가

      eventTimer = setInterval(() => {
        if (!isGrowing) triggerEvent();
      }, 5000); // 5초마다 이벤트

      setInterval(() => {
        if (eventCountdown > 0) {
          eventCountdown--;
        } else {
          eventCountdown = 5;
        }
        document.getElementById("event-timer").innerText = eventCountdown;
      }, 1000);
    }

    function updateUI() {
      document.getElementById("age").innerText = puppy.age;
      document.getElementById("bond").innerText = puppy.bond;
      document.getElementById("hunger").innerText = puppy.hunger;

      let stage = 1;
      if (puppy.age >= 2 && puppy.age < 6) stage = 2;
      else if (puppy.age >= 6 && puppy.age < 10) stage = 3;
      else if (puppy.age >= 10) stage = 4;

      const imgBase = puppy.breed === "골든 리트리버" ? "g" : "b";
      document.getElementById("puppyImage").src = `https://dessa1995.github.io/dessa/${imgBase}${stage}.png`;
    }

    function checkGrowth() {
      if (puppy.age === 2 || puppy.age === 6 || puppy.age === 10) {
        isGrowing = true;
        const eff = document.createElement("div");
        eff.innerText = "🎉 성장했어요!";
        eff.style.position = "absolute";
        eff.style.top = "50%";
        eff.style.left = "50%";
        eff.style.transform = "translate(-50%, -50%)";
        eff.style.fontSize = "2rem";
        eff.style.backgroundColor = "#fcd5ce";
        eff.style.padding = "10px";
        eff.style.borderRadius = "12px";
        eff.style.zIndex = "99";
        document.getElementById("game-wrapper").appendChild(eff);

        setTimeout(() => {
          eff.remove();
          isGrowing = false;
        }, 2000);
      }
    }
    function toggleInteraction() {
      const box = document.getElementById("interaction-box");
      box.style.display = (box.style.display === "none") ? "flex" : "none";
    }

    function interact(action) {
      const reactions = {
        "귀 냄새 맡기": "😊 킁킁! 좋아하는 냄새야!",
        "발 냄새 맡기": "😆 우와~ 간질간질해!",
        "껴안기": "💖 따뜻해서 좋아!",
        "쓰다듬기": "🥰 기분 최고야!"
      };

      showFloatingReaction(reactions[action] || "좋아!");
      puppy.bond = Math.min(puppy.bond + 3, 100);
      puppy.hunger = Math.max(puppy.hunger - 2, 0);
      updateUI();
    }

    function showFloatingReaction(text) {
      const eff = document.createElement("div");
      eff.innerText = text;
      eff.style.position = "absolute";
      eff.style.top = "55%";
      eff.style.left = "50%";
      eff.style.transform = "translate(-50%, -50%)";
      eff.style.fontSize = "1.5rem";
      eff.style.padding = "8px 14px";
      eff.style.borderRadius = "10px";
      eff.style.background = "#fff4bd";
      eff.style.border = "1px solid #f0d586";
      eff.style.zIndex = "100";
      eff.style.animation = "fadeout 2s forwards";

      document.getElementById("game-wrapper").appendChild(eff);
      setTimeout(() => eff.remove(), 2000);
    }

    function triggerEvent() {
      const events = [
        { text: `${puppy.name}가 배고파해요`, choices: ["간식 주기", "무시하기"], effects: [+2, -3] },
        { text: `${puppy.name}가 심심해해요`, choices: ["놀아주기", "무시하기"], effects: [+3, -2] },
        { text: `${puppy.name}가 졸려 해요`, choices: ["재워주기", "깨우기"], effects: [+1, -1] },
        { text: `${puppy.name}가 눈을 반짝이며 쳐다봐요`, choices: ["쓰다듬기", "무시하기"], effects: [+2, -2] },
        { text: `${puppy.name}가 짖고 있어요`, choices: ["달래기", "혼내기"], effects: [+1, -1] },
        { text: `${puppy.name}가 혼자 있어서 외로워해요`, choices: ["껴안기", "무시하기"], effects: [+2, -3] },
        { text: `${puppy.name}가 방을 어질렀어요`, choices: ["혼내기", "참기"], effects: [-1, +1] },
        { text: `${puppy.name}가 아파보여요`, choices: ["병원가기", "지켜보기"], effects: [+3, -2] },
        { text: `${puppy.name}가 땅바닥에 드러누웠어요`, choices: ["간식주기", "그냥둠"], effects: [+1, -2] },
        { text: `${puppy.name}가 장난감을 찾았어요`, choices: ["같이 놀기", "무시하기"], effects: [+3, -1] }
      ];

      const selected = events[Math.floor(Math.random() * events.length)];
      document.getElementById("event-box").style.display = "block";
      document.getElementById("event-text").innerText = selected.text;

      const choiceBox = document.getElementById("event-choices");
      choiceBox.innerHTML = "";

      selected.choices.forEach((choice, i) => {
        const btn = document.createElement("button");
        btn.innerText = choice;
        btn.onclick = () => {
          puppy.bond = Math.min(puppy.bond + selected.effects[i], 100);
          puppy.hunger = Math.min(puppy.hunger + (i === 0 ? -1 : +1), 100);
          updateUI();
          document.getElementById("event-box").style.display = "none";
        };
        choiceBox.appendChild(btn);
      });
    }

    function showConfetti() {
      const confetti = document.createElement("div");
      confetti.innerText = "🎉";
      confetti.style.position = "absolute";
      confetti.style.top = "30%";
      confetti.style.left = "50%";
      confetti.style.fontSize = "4rem";
      confetti.style.transform = "translate(-50%, -50%) scale(1)";
      confetti.style.animation = "pop 1.5s ease-out forwards";

      document.getElementById("game-wrapper").appendChild(confetti);
      setTimeout(() => confetti.remove(), 1500);
    }
    function showAlbum() {
      document.getElementById("album").style.display = "block";
      document.getElementById("album-name").innerText = `${puppy.name}의 추억 앨범`;
      const imgStage = puppy.age < 2 ? 1 : puppy.age < 6 ? 2 : puppy.age < 10 ? 3 : 4;
      const imgBase = puppy.breed === "골든 리트리버" ? "g" : "b";
      document.getElementById("album-img").src = `https://dessa1995.github.io/dessa/${imgBase}${imgStage}.png`;

      document.getElementById("game-wrapper").style.display = "none";
    }

    function endGame() {
      clearInterval(ageTimer);
      clearInterval(eventTimer);
      setTimeout(showAlbum, 3000);
    }

    document.getElementById("restartBtn").onclick = () => {
      location.reload();
    };

    window.onload = () => {
      document.getElementById("interaction-toggle").addEventListener("click", toggleInteraction);
      document.getElementById("interaction-box").style.display = "none";
    };
  </script>

  <style>
    @keyframes fadeout {
      0% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
      100% { opacity: 0; transform: translate(-50%, -100%) scale(1.5); }
    }

    @keyframes pop {
      0% { transform: translate(-50%, -50%) scale(0.2); opacity: 0.2; }
      50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
      100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
    }

    #album {
      display: none;
      text-align: center;
      margin-top: 30px;
    }

    #album h2 {
      color: #a0522d;
    }

    #album-img {
      width: 220px;
      border-radius: 12px;
      border: 3px solid #d4a373;
      margin-top: 10px;
    }

    #restartBtn {
      margin-top: 20px;
      padding: 10px 18px;
      background-color: #faedcd;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-size: 1rem;
    }

    #restartBtn:hover {
      background-color: #f9db9b;
    }
  </style>

  <div id="album">
    <h2 id="album-name"></h2>
    <img id="album-img" src="" alt="추억 이미지" />
    <br />
    <button id="restartBtn">다시 시작하기</button>
  </div>
</body>
</html>
