<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>강아지 육성 게임</title>
  <link rel="icon" href="data:,">
  <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable.css" rel="stylesheet" />
  <style>
    body {
      margin: 0;
      font-family: 'Pretendard Variable', sans-serif;
      background-color: #fefae0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1, h2, h3 {
      margin: 0.5em;
      color: #6c584c;
    }
    button {
      font-family: inherit;
      font-size: 1rem;
      padding: 10px 20px;
      margin: 10px;
      background-color: #b5ead7;
      border: none;
      border-radius: 12px;
      cursor: pointer;
    }
    button:hover {
      background-color: #9de0c6;
    }
    .screen {
      display: none;
      text-align: center;
      padding: 20px;
      max-width: 800px;
      width: 100%;
    }
    .active {
      display: block;
    }
    .status-box {
      background: #fff;
      border-radius: 10px;
      padding: 10px;
      margin-bottom: 10px;
      font-size: 1.1rem;
      display: flex;
      justify-content: space-around;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    #dogImage {
      width: 280px;
      height: auto;
      border-radius: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      margin: 10px auto;
      transition: transform 0.3s ease;
    }
    .emoji {
      font-size: 2rem;
      margin-top: 10px;
    }
    .event-box, .interaction-buttons {
      margin: 10px 0;
      padding: 10px;
      background: #fff7f0;
      border: 2px dashed #ffc8a2;
      border-radius: 12px;
    }
    .event-text {
      margin: 10px 0;
      font-size: 1.2rem;
    }
    .choice-button {
      display: inline-block;
      margin: 5px;
      padding: 8px 16px;
      font-size: 1rem;
      background-color: #f7b267;
      color: #fff;
      border: none;
      border-radius: 8px;
    }
    .choice-button:hover {
      background-color: #f79d65;
    }
    .hidden {
      display: none;
    }
    #interaction-buttons button {
      background-color: #cdb4db;
    }
    #interaction-buttons button:hover {
      background-color: #bfa2d5;
    }
    #event-timer {
      font-size: 1rem;
      margin-top: 8px;
      color: #555;
    }
    #congratsEffect {
      font-size: 2rem;
      animation: pop 0.4s ease-in-out;
      color: #ff5d8f;
    }
    @keyframes pop {
      0% { transform: scale(1); opacity: 0.2; }
      50% { transform: scale(1.3); opacity: 1; }
      100% { transform: scale(1); opacity: 0.8; }
    }
    #album-screen img {
      max-width: 250px;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
    }
    #album-screen p {
      margin: 15px 0;
      font-size: 1.2rem;
    }
  </style>
</head>
<body>
  <audio id="bgm" src="https://dessa1995.github.io/dessa/bgm.mp3" loop autoplay></audio>

  <div id="start-screen" class="screen active">
    <h1>🐾 강아지 육성 게임</h1>
    <button onclick="goToBreedSelection()">게임 시작</button>
  </div>

  <div id="breed-screen" class="screen">
    <h2>품종을 선택하세요</h2>
    <button onclick="selectBreed('golden')">골든리트리버</button>
    <button onclick="selectBreed('bichon')">비숑프리제</button>
  </div>

  <div id="name-screen" class="screen">
    <h2>강아지 이름을 지어주세요</h2>
    <input type="text" id="dogNameInput" placeholder="이름 입력" />
    <br />
    <button onclick="startGame()">입력 완료</button>
  </div>

  <div id="game-screen" class="screen">
    <h2 id="dogNameDisplay"></h2>
    <div class="status-box">
      <div>나이: <span id="age">0</span>살</div>
      <div>친밀도: <span id="affection">50</span></div>
      <div>배고픔: <span id="hunger">50</span></div>
    </div>
    <img id="dogImage" src="" alt="강아지 이미지" />
    <div class="emoji" id="emoji">🐶</div>
    <p style="font-size: 1rem; color: #777;">이벤트는 5초마다 한 번씩 등장해요!</p>
<div id="event-timer">다음 이벤트까지: <span id="countdown">5</span>초</div>
    <div class="event-box" id="eventBox" style="display:none;">
      <div class="event-text" id="eventText"></div>
      <div id="eventChoices"></div>
    </div>
    <button onclick="toggleInteractionButtons()">직접 상호작용하기</button>
    <div class="interaction-buttons hidden" id="interaction-buttons">
      <button onclick="interact('귀 냄새 맡기')">귀 냄새 맡기</button>
      <button onclick="interact('발 냄새 맡기')">발 냄새 맡기</button>
      <button onclick="interact('껴안기')">껴안기</button>
      <button onclick="interact('쓰다듬기')">쓰다듬기</button>
      <button onclick="interact('산책하기')">산책하기</button>
      <button onclick="interact('배 긁기')">배 긁기</button>
      <button onclick="interact('장난감 던지기')">장난감 던지기</button>
    </div>
  </div>

  <div id="album-screen" class="screen">
    <h2>🎉 추억 앨범</h2>
    <img id="album-img" src="" alt="최종 강아지" />
    <p id="albumText"></p>
    <button onclick="location.reload()">다시 시작하기</button>
  </div>

  <script>
    let breed = '';
    let age = 0;
    let affection = 50;
    let hunger = 50;
    let dogName = '';
    let eventInterval;
    let ageInterval;
    let countdownInterval;
    let eventCountdown = 5;
    let inEvent = false;

    const breedImages = {
      golden: ['g1.png', 'g2.png', 'g3.png', 'g4.png'],
      bichon: ['b1.png', 'b2.png', 'b3.png', 'b4.png']
    };

    const screens = ['start-screen', 'breed-screen', 'name-screen', 'game-screen', 'album-screen'];

    function switchScreen(screenId) {
      screens.forEach(id => document.getElementById(id).classList.remove('active'));
      document.getElementById(screenId).classList.add('active');
    }

    function goToBreedSelection() {
      switchScreen('breed-screen');
    }

    function selectBreed(selected) {
      breed = selected;
      switchScreen('name-screen');
    }

    function startGame() {
      dogName = document.getElementById('dogNameInput').value || '강아지';
      document.getElementById('dogNameDisplay').innerText = dogName;
      updateDogImage();
      switchScreen('game-screen');
      startTimers();
document.getElementById("bgm").play(); 
    }

    function updateDogImage() {
      const img = document.getElementById('dogImage');
      let stage = 0;
      if (age < 2) stage = 0;
      else if (age < 6) stage = 1;
      else if (age < 10) stage = 2;
      else stage = 3;
      img.src = `https://dessa1995.github.io/dessa/${breedImages[breed][stage]}`;
    }

    function startTimers() {
      ageInterval = setInterval(() => {
        if (!inEvent) {
          age++;
          document.getElementById('age').innerText = age;
          updateDogImage();
          if ([3, 7, 11].includes(age)) {
            showGrowthAnimation();
          }
          if (age >= 12) {
            endGame();
          }
        }
      }, 10000);

      eventInterval = setInterval(() => {
        if (!inEvent && age < 12) {
          triggerRandomEvent();
        }
      }, 5000);

      countdownInterval = setInterval(() => {
        if (!inEvent && age < 12) {
          eventCountdown--;
          if (eventCountdown <= 0) eventCountdown = 5;
          document.getElementById('countdown').innerText = eventCountdown;
        }
      }, 1000);
    }

    function showGrowthAnimation() {
      const img = document.getElementById('dogImage');
      img.style.transition = 'transform 0.3s';
      img.style.transform = 'scale(1.2)';
      setTimeout(() => {
        img.style.transform = 'scale(1)';
      }, 300);
      const emoji = document.getElementById('emoji');
      emoji.innerText = '🎉';
      setTimeout(() => {
        emoji.innerText = '🐶';
      }, 1000);
    }

    function toggleInteractionButtons() {
      const buttons = document.getElementById('interaction-buttons');
      buttons.classList.toggle('hidden');
    }

    function interact(type) {
      if (age >= 12) return;
      affection += 3;
      if (affection > 100) affection = 100;
      document.getElementById('affection').innerText = affection;
      const emoji = document.getElementById('emoji');
      emoji.innerText = '💗';
      const img = document.getElementById('dogImage');
      img.style.animation = 'pop 0.4s ease-in-out';
      setTimeout(() => {
        emoji.innerText = '🐶';
        img.style.animation = '';
      }, 800);
    }
    function triggerRandomEvent() {
      inEvent = true;
      clearInterval(countdownInterval);
      const events = [
        { text: `${dogName}가 배고파해요.`, options: ['간식을 준다', '무시한다'], effects: [5, -5] },
        { text: `${dogName}가 산책 가고 싶어 해요.`, options: ['같이 나간다', '모른 척한다'], effects: [5, -5] },
        { text: `${dogName}가 혼자 놀고 있어요.`, options: ['같이 논다', '그냥 둔다'], effects: [5, -3] },
        { text: `${dogName}가 슬퍼 보여요.`, options: ['쓰다듬는다', '모른 척한다'], effects: [5, -5] },
        { text: `${dogName}가 짖고 있어요.`, options: ['말을 건다', '무시한다'], effects: [4, -4] },
        { text: `${dogName}가 무언가 찾고 있어요.`, options: ['도와준다', '방치한다'], effects: [5, -3] },
        { text: `${dogName}가 지루해해요.`, options: ['장난감을 던진다', '무시한다'], effects: [5, -5] },
        { text: `${dogName}가 졸려 보여요.`, options: ['포근히 안아준다', '모른 척한다'], effects: [4, -2] },
        { text: `${dogName}가 꼬리를 흔들어요.`, options: ['같이 반응한다', '무시한다'], effects: [4, -4] },
        { text: `${dogName}가 물을 엎질렀어요.`, options: ['닦아준다', '혼낸다'], effects: [3, -3] },
      ];
      const e = events[Math.floor(Math.random() * events.length)];

      const container = document.createElement('div');
      container.style.position = 'absolute';
      container.style.top = '50%';
      container.style.left = '50%';
      container.style.transform = 'translate(-50%, -50%)';
      container.style.background = '#fff8f0';
      container.style.border = '2px solid #ffe0b3';
      container.style.padding = '20px';
      container.style.boxShadow = '0 0 10px rgba(0,0,0,0.1)';
      container.style.zIndex = 1000;
      container.style.borderRadius = '12px';
      container.style.textAlign = 'center';

      const text = document.createElement('p');
      text.innerText = e.text;
      text.style.marginBottom = '15px';

      const btn1 = document.createElement('button');
      btn1.innerText = e.options[0];
      btn1.style.margin = '5px';
      btn1.onclick = () => {
        affection += e.effects[0];
        hunger -= 2;
        cleanupEvent(container);
      };

      const btn2 = document.createElement('button');
      btn2.innerText = e.options[1];
      btn2.style.margin = '5px';
      btn2.onclick = () => {
        affection += e.effects[1];
        hunger += 2;
        cleanupEvent(container);
      };

      container.appendChild(text);
      container.appendChild(btn1);
      container.appendChild(btn2);
      document.body.appendChild(container);

      function cleanupEvent(box) {
        if (affection > 100) affection = 100;
        if (affection < 0) affection = 0;
        if (hunger > 100) hunger = 100;
        if (hunger < 0) hunger = 0;
        document.getElementById('affection').innerText = affection;
        document.getElementById('hunger').innerText = hunger;
        document.body.removeChild(box);
        inEvent = false;
        eventCountdown = 5;
        document.getElementById('countdown').innerText = eventCountdown;
        countdownInterval = setInterval(() => {
          if (!inEvent && age < 12) {
            eventCountdown--;
            if (eventCountdown <= 0) eventCountdown = 5;
            document.getElementById('countdown').innerText = eventCountdown;
          }
        }, 1000);
      }
    }

    function endGame() {
      clearInterval(ageInterval);
      clearInterval(eventInterval);
      clearInterval(countdownInterval);
      document.getElementById('album-img').src = document.getElementById('dogImage').src;
      document.getElementById('albumText').innerText = `${dogName}가 예쁘고 멋지게 자랐어요!`;
      switchScreen('album-screen');
    }
  </script>
</body>
</html>
