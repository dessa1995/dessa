<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ê°•ì•„ì§€ ìœ¡ì„± ê²Œì„</title>
  <link rel="icon" href="data:,">
  <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable.css" rel="stylesheet" />
  <style>
    /* ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
    body {
      margin: 0;
      font-family: 'Pretendard Variable', sans-serif;
      background-color: #fefae0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
    }
    h1, h2, h3 {
      margin: 0.5em;
      color: #6c584c;
    }
    button {
      font-family: inherit;
      font-size: 1rem;
      padding: 10px 20px;
      margin: 10px;
      background-color: #b5ead7;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    button:hover {
      background-color: #9de0c6;
    }
    input[type="text"] {
        padding: 10px;
        border-radius: 8px;
        border: 1px solid #ccc;
        margin-bottom: 10px;
        font-family: inherit;
    }
    /* í™”ë©´ ì „í™˜ ê´€ë ¨ ìŠ¤íƒ€ì¼ */
    .screen {
      display: none;
      text-align: center;
      padding: 20px;
      max-width: 800px;
      width: 90%;
    }
    .active {
      display: block;
    }
    /* ê²Œì„ í™”ë©´ ìŠ¤íƒ€ì¼ */
    .status-box {
      background: #fff;
      border-radius: 10px;
      padding: 10px;
      margin-bottom: 10px;
      font-size: 1.1rem;
      display: flex;
      justify-content: space-around;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    #dogImage {
      width: 280px;
      height: auto;
      border-radius: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      margin: 10px auto;
      transition: transform 0.3s ease;
    }
    .emoji {
      font-size: 2rem;
      margin-top: 10px;
    }
    /* ì¶”ê°€ëœ ìƒí˜¸ì‘ìš© í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
    .interaction-text {
        color: #e56b6f;
        font-size: 1.1rem;
        font-weight: bold;
        margin-top: 10px;
        height: 1.2em; /* ë ˆì´ì•„ì›ƒ ë³€ê²½ ë°©ì§€ë¥¼ ìœ„í•´ ë†’ì´ ê³ ì • */
        transition: opacity 0.3s;
    }
    .event-box, .interaction-buttons {
      margin: 10px 0;
      padding: 10px;
      background: #fff7f0;
      border: 2px dashed #ffc8a2;
      border-radius: 12px;
    }
    .hidden {
      display: none;
    }
    #interaction-buttons button {
      background-color: #cdb4db;
    }
    #interaction-buttons button:hover {
      background-color: #bfa2d5;
    }
    #event-timer {
      font-size: 1rem;
      margin-top: 8px;
      color: #555;
    }
    /* ì•¨ë²” í™”ë©´ ìŠ¤íƒ€ì¼ */
    #album-screen img {
      max-width: 250px;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
    }
    #album-screen p {
      margin: 15px 0;
      font-size: 1.2rem;
    }
    /* ì• ë‹ˆë©”ì´ì…˜ */
    @keyframes pop {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }
  </style>
</head>
<body>
  <!-- BGM ì˜¤ë””ì˜¤ -->
  <audio id="bgm" src="https://dessa1995.github.io/dessa/bgm.mp3" loop></audio>

  <!-- ì‹œì‘ í™”ë©´ -->
  <div id="start-screen" class="screen active">
    <h1>ğŸ¾ ê°•ì•„ì§€ ìœ¡ì„± ê²Œì„</h1>
    <button onclick="goToBreedSelection()">ê²Œì„ ì‹œì‘</button>
  </div>

  <!-- í’ˆì¢… ì„ íƒ í™”ë©´ -->
  <div id="breed-screen" class="screen">
    <h2>í’ˆì¢…ì„ ì„ íƒí•˜ì„¸ìš”</h2>
    <button onclick="selectBreed('golden')">ê³¨ë“ ë¦¬íŠ¸ë¦¬ë²„</button>
    <button onclick="selectBreed('bichon')">ë¹„ìˆ‘í”„ë¦¬ì œ</button>
  </div>

  <!-- ì´ë¦„ ì…ë ¥ í™”ë©´ -->
  <div id="name-screen" class="screen">
    <h2>ê°•ì•„ì§€ ì´ë¦„ì„ ì§€ì–´ì£¼ì„¸ìš”</h2>
    <input type="text" id="dogNameInput" placeholder="ì´ë¦„ ì…ë ¥" />
    <br />
    <button onclick="startGame()">ì…ë ¥ ì™„ë£Œ</button>
  </div>

  <!-- ë©”ì¸ ê²Œì„ í™”ë©´ -->
  <div id="game-screen" class="screen">
    <h2 id="dogNameDisplay"></h2>
    <div class="status-box">
      <div>ë‚˜ì´: <span id="age">0</span>ì‚´</div>
      <div>ì¹œë°€ë„: <span id="affection">50</span></div>
      <div>ë°°ê³ í””: <span id="hunger">50</span></div>
    </div>
    <img id="dogImage" src="" alt="ê°•ì•„ì§€ ì´ë¯¸ì§€" />
    <div class="emoji" id="emoji">ğŸ¶</div>
    <!-- ìƒí˜¸ì‘ìš© í…ìŠ¤íŠ¸ê°€ í‘œì‹œë  ê³µê°„ -->
    <p id="interaction-text" class="interaction-text"></p>
    <p style="font-size: 1rem; color: #777;">ì´ë²¤íŠ¸ëŠ” 5ì´ˆë§ˆë‹¤ í•œ ë²ˆì”© ë“±ì¥í•´ìš”!</p>
    <div id="event-timer">ë‹¤ìŒ ì´ë²¤íŠ¸ê¹Œì§€: <span id="countdown">5</span>ì´ˆ</div>
    <button onclick="toggleInteractionButtons()">ì§ì ‘ ìƒí˜¸ì‘ìš©í•˜ê¸°</button>
    <div class="interaction-buttons hidden" id="interaction-buttons">
      <button onclick="interact('ê·€ ëƒ„ìƒˆ ë§¡ê¸°')">ê·€ ëƒ„ìƒˆ ë§¡ê¸°</button>
      <button onclick="interact('ë°œ ëƒ„ìƒˆ ë§¡ê¸°')">ë°œ ëƒ„ìƒˆ ë§¡ê¸°</button>
      <button onclick="interact('ê»´ì•ˆê¸°')">ê»´ì•ˆê¸°</button>
      <button onclick="interact('ì“°ë‹¤ë“¬ê¸°')">ì“°ë‹¤ë“¬ê¸°</button>
      <button onclick="interact('ì‚°ì±…í•˜ê¸°')">ì‚°ì±…í•˜ê¸°</button>
      <button onclick="interact('ë°° ê¸ê¸°')">ë°° ê¸ê¸°</button>
      <button onclick="interact('ì¥ë‚œê° ë˜ì§€ê¸°')">ì¥ë‚œê° ë˜ì§€ê¸°</button>
    </div>
  </div>

  <!-- ì•¨ë²” í™”ë©´ -->
  <div id="album-screen" class="screen">
    <h2>ğŸ‰ ì¶”ì–µ ì•¨ë²”</h2>
    <img id="album-img" src="" alt="ìµœì¢… ê°•ì•„ì§€" />
    <p id="albumText"></p>
    <button onclick="location.reload()">ë‹¤ì‹œ ì‹œì‘í•˜ê¸°</button>
  </div>

  <script>
    // ê²Œì„ ë³€ìˆ˜ ì„¤ì •
    let breed = '';
    let age = 0;
    let affection = 50;
    let hunger = 50;
    let dogName = '';
    let eventInterval;
    let ageInterval;
    let countdownInterval;
    let eventCountdown = 5;
    let inEvent = false;

    // í’ˆì¢…ë³„ ì´ë¯¸ì§€ ê²½ë¡œ
    const breedImages = {
      golden: ['g1.png', 'g2.png', 'g3.png', 'g4.png'],
      bichon: ['b1.png', 'b2.png', 'b3.png', 'b4.png']
    };

    const screens = ['start-screen', 'breed-screen', 'name-screen', 'game-screen', 'album-screen'];

    // í™”ë©´ ì „í™˜ í•¨ìˆ˜
    function switchScreen(screenId) {
      screens.forEach(id => document.getElementById(id).classList.remove('active'));
      document.getElementById(screenId).classList.add('active');
    }

    function goToBreedSelection() {
      switchScreen('breed-screen');
    }

    function selectBreed(selected) {
      breed = selected;
      switchScreen('name-screen');
    }

    // ê²Œì„ ì‹œì‘ í•¨ìˆ˜
    function startGame() {
      dogName = document.getElementById('dogNameInput').value || 'ê°•ì•„ì§€';
      document.getElementById('dogNameDisplay').innerText = dogName;
      updateDogImage();
      switchScreen('game-screen');
      startTimers();
      document.getElementById("bgm").play().catch(e => console.log("ìë™ ì¬ìƒì´ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤."));
    }

    // ê°•ì•„ì§€ ì´ë¯¸ì§€ ì—…ë°ì´íŠ¸
    function updateDogImage() {
      const img = document.getElementById('dogImage');
      let stage = 0;
      if (age < 3) stage = 0;
      else if (age < 7) stage = 1;
      else if (age < 11) stage = 2;
      else stage = 3;
      img.src = `https://dessa1995.github.io/dessa/${breedImages[breed][stage]}`;
    }

    // íƒ€ì´ë¨¸ ì‹œì‘
    function startTimers() {
      ageInterval = setInterval(() => {
        if (inEvent) return; // ì´ë²¤íŠ¸ ì¤‘ì—ëŠ” ë‚˜ì´ ì¦ê°€í•˜ì§€ ì•ŠìŒ
        
        age++;
        document.getElementById('age').innerText = age;
        updateDogImage();

        // *** ì„±ì¥ ì´ë²¤íŠ¸ ì²´í¬ ***
        if ([3, 7, 11].includes(age)) {
          showGrowthEvent(); // ì„±ì¥ ì´ë²¤íŠ¸ ë°œìƒ
        }

        if (age >= 12) {
          endGame();
        }
      }, 10000);

      eventInterval = setInterval(() => {
        if (!inEvent && age < 12) {
          triggerRandomEvent();
        }
      }, 5000);

      countdownInterval = setInterval(() => {
        if (!inEvent && age < 12) {
          eventCountdown--;
          if (eventCountdown <= 0) eventCountdown = 5;
          document.getElementById('countdown').innerText = eventCountdown;
        }
      }, 1000);
    }

    // ì„±ì¥ ì• ë‹ˆë©”ì´ì…˜
    function showGrowthAnimation() {
      const img = document.getElementById('dogImage');
      img.style.transition = 'transform 0.3s';
      img.style.transform = 'scale(1.1)';
      setTimeout(() => {
        img.style.transform = 'scale(1)';
      }, 300);
      const emoji = document.getElementById('emoji');
      emoji.innerText = 'ï¿½';
      setTimeout(() => {
        emoji.innerText = 'ğŸ¶';
      }, 1000);
    }
    
    // *** ìƒˆë¡œ ì¶”ê°€ëœ ì„±ì¥ ì´ë²¤íŠ¸ í•¨ìˆ˜ ***
    function showGrowthEvent() {
        inEvent = true; // ê²Œì„ ì¼ì‹œì •ì§€
        clearInterval(countdownInterval); // ì´ë²¤íŠ¸ ì¹´ìš´íŠ¸ë‹¤ìš´ ì •ì§€
        showGrowthAnimation(); // ì‹œê°ì  íš¨ê³¼

        // íŒì—… ì»¨í…Œì´ë„ˆ ìƒì„±
        const container = document.createElement('div');
        container.style.position = 'fixed';
        container.style.top = '50%';
        container.style.left = '50%';
        container.style.transform = 'translate(-50%, -50%)';
        container.style.background = '#fff8f0';
        container.style.border = '3px solid #f7b267';
        container.style.padding = '25px';
        container.style.boxShadow = '0 5px 15px rgba(0,0,0,0.2)';
        container.style.zIndex = 1000;
        container.style.borderRadius = '15px';
        container.style.textAlign = 'center';

        // íŒì—… í…ìŠ¤íŠ¸
        const text = document.createElement('p');
        text.innerText = `ğŸ‰ ê²½ì¶•! ${dogName}ê°€ í•œ ë¼˜ ë” ìëì–´ìš”! ğŸ‰`;
        text.style.marginBottom = '20px';
        text.style.fontSize = '1.3rem';
        text.style.fontWeight = 'bold';
        text.style.color = '#d9534f';

        // í™•ì¸ ë²„íŠ¼
        const okButton = document.createElement('button');
        okButton.innerText = 'í™•ì¸';
        okButton.style.backgroundColor = '#f7b267';
        okButton.style.color = 'white';
        okButton.onclick = () => {
            document.body.removeChild(container);
            inEvent = false; // ê²Œì„ ì¬ê°œ
            eventCountdown = 5; // ì¹´ìš´íŠ¸ë‹¤ìš´ ë¦¬ì…‹
            document.getElementById('countdown').innerText = eventCountdown;
            // ì¹´ìš´íŠ¸ë‹¤ìš´ ì¸í„°ë²Œ ì¬ì‹œì‘
            countdownInterval = setInterval(() => {
              if (!inEvent && age < 12) {
                eventCountdown--;
                if (eventCountdown <= 0) eventCountdown = 5;
                document.getElementById('countdown').innerText = eventCountdown;
              }
            }, 1000);
        };

        container.appendChild(text);
        container.appendChild(okButton);
        document.body.appendChild(container);
    }


    // ìƒí˜¸ì‘ìš© ë²„íŠ¼ í† ê¸€
    function toggleInteractionButtons() {
      const buttons = document.getElementById('interaction-buttons');
      buttons.classList.toggle('hidden');
    }

    // ìƒí˜¸ì‘ìš© í•¨ìˆ˜
    function interact(type) {
      if (age >= 12 || inEvent) return; 

      const interactionMessages = {
        'ê·€ ëƒ„ìƒˆ ë§¡ê¸°': `${dogName}ê°€ ê³ ì†Œí•œ ëƒ„ìƒˆë¥¼ í’ê¸°ë©° ê¼¬ë¦¬ë¥¼ ì‚´ë‘ê±°ë¦½ë‹ˆë‹¤.`,
        'ë°œ ëƒ„ìƒˆ ë§¡ê¸°': `${dogName}ê°€ ê¼¬ìˆœë‚´ ë‚˜ëŠ” ë°œì„ ë‚´ì–´ì£¼ë©° ë‹¹ì‹ ì„ í•¥ìŠµë‹ˆë‹¤.`,
        'ê»´ì•ˆê¸°': `í¬ê·¼í•œ ì˜¨ê¸°ê°€ ëŠê»´ì§‘ë‹ˆë‹¤. ${dogName}ê°€ ë‹¹ì‹ ì˜ í’ˆì— íŒŒê³ ë“­ë‹ˆë‹¤.`,
        'ì“°ë‹¤ë“¬ê¸°': `${dogName}ê°€ ê¸°ë¶„ ì¢‹ì€ ë“¯ ëˆˆì„ ì§€ê·¸ì‹œ ê°ìŠµë‹ˆë‹¤.`,
        'ì‚°ì±…í•˜ê¸°': `ì‹ ë‚˜ì„œ í—¥í—¥! ${dogName}ê°€ ë‹¹ì‹ ê³¼ í•¨ê»˜ ë›°ëŠ” ê²ƒì„ ì •ë§ ì¢‹ì•„í•©ë‹ˆë‹¤!`,
        'ë°° ê¸ê¸°': `${dogName}ê°€ ë°œë¼ë‹¹ ëˆ„ì›Œ ë°°ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤. ê¸°ë¶„ì´ ìµœê³ ì˜ˆìš”!`,
        'ì¥ë‚œê° ë˜ì§€ê¸°': `${dogName}ê°€ ìœì‚´ê°™ì´ ë‹¬ë ¤ê°€ ì¥ë‚œê°ì„ ë¬¼ì–´ì˜µë‹ˆë‹¤! ë˜ ë˜ì ¸ì£¼ì„¸ìš”!`
      };

      affection += 3;
      if (affection > 100) affection = 100;
      document.getElementById('affection').innerText = affection;

      const emoji = document.getElementById('emoji');
      emoji.innerText = 'ğŸ’—';
      const img = document.getElementById('dogImage');
      img.style.animation = 'pop 0.4s ease-in-out';

      const interactionText = document.getElementById('interaction-text');
      interactionText.innerText = interactionMessages[type] || 'ê°•ì•„ì§€ê°€ ì¢‹ì•„í•©ë‹ˆë‹¤!';
      interactionText.style.display = 'block';

      setTimeout(() => {
        emoji.innerText = 'ğŸ¶';
        img.style.animation = '';
        interactionText.style.display = 'none'; 
        interactionText.innerText = ''; 
      }, 2000); 
    }

    // ëœë¤ ì´ë²¤íŠ¸ ë°œìƒ
    function triggerRandomEvent() {
      inEvent = true;
      clearInterval(countdownInterval);
      const events = [
        { text: `${dogName}ê°€ ë°°ê³ íŒŒí•´ìš”.`, options: ['ê°„ì‹ì„ ì¤€ë‹¤', 'ë¬´ì‹œí•œë‹¤'], effects: [5, -5] },
        { text: `${dogName}ê°€ ì‚°ì±… ê°€ê³  ì‹¶ì–´ í•´ìš”.`, options: ['ê°™ì´ ë‚˜ê°„ë‹¤', 'ëª¨ë¥¸ ì²™í•œë‹¤'], effects: [5, -5] },
        { text: `${dogName}ê°€ í˜¼ì ë†€ê³  ìˆì–´ìš”.`, options: ['ê°™ì´ ë…¼ë‹¤', 'ê·¸ëƒ¥ ë‘”ë‹¤'], effects: [5, -3] },
        { text: `${dogName}ê°€ ìŠ¬í¼ ë³´ì—¬ìš”.`, options: ['ì“°ë‹¤ë“¬ëŠ”ë‹¤', 'ëª¨ë¥¸ ì²™í•œë‹¤'], effects: [5, -5] },
        { text: `${dogName}ê°€ ì§–ê³  ìˆì–´ìš”.`, options: ['ë§ì„ ê±´ë‹¤', 'ë¬´ì‹œí•œë‹¤'], effects: [4, -4] },
        { text: `${dogName}ê°€ ë¬´ì–¸ê°€ ì°¾ê³  ìˆì–´ìš”.`, options: ['ë„ì™€ì¤€ë‹¤', 'ë°©ì¹˜í•œë‹¤'], effects: [5, -3] },
        { text: `${dogName}ê°€ ì§€ë£¨í•´í•´ìš”.`, options: ['ì¥ë‚œê°ì„ ë˜ì§„ë‹¤', 'ë¬´ì‹œí•œë‹¤'], effects: [5, -5] },
        { text: `${dogName}ê°€ ì¡¸ë ¤ ë³´ì—¬ìš”.`, options: ['í¬ê·¼íˆ ì•ˆì•„ì¤€ë‹¤', 'ëª¨ë¥¸ ì²™í•œë‹¤'], effects: [4, -2] },
        { text: `${dogName}ê°€ ê¼¬ë¦¬ë¥¼ í”ë“¤ì–´ìš”.`, options: ['ê°™ì´ ë°˜ì‘í•œë‹¤', 'ë¬´ì‹œí•œë‹¤'], effects: [4, -4] },
        { text: `${dogName}ê°€ ë¬¼ì„ ì—ì§ˆë €ì–´ìš”.`, options: ['ë‹¦ì•„ì¤€ë‹¤', 'í˜¼ë‚¸ë‹¤'], effects: [3, -3] },
      ];
      const e = events[Math.floor(Math.random() * events.length)];

      const container = document.createElement('div');
      container.style.position = 'fixed';
      container.style.top = '50%';
      container.style.left = '50%';
      container.style.transform = 'translate(-50%, -50%)';
      container.style.background = '#fff8f0';
      container.style.border = '2px solid #ffe0b3';
      container.style.padding = '20px';
      container.style.boxShadow = '0 0 10px rgba(0,0,0,0.1)';
      container.style.zIndex = 1000;
      container.style.borderRadius = '12px';
      container.style.textAlign = 'center';

      const text = document.createElement('p');
      text.innerText = e.text;
      text.style.marginBottom = '15px';

      const btn1 = document.createElement('button');
      btn1.innerText = e.options[0];
      btn1.style.margin = '5px';
      btn1.onclick = () => {
        affection += e.effects[0];
        hunger -= 2;
        cleanupEvent(container);
      };

      const btn2 = document.createElement('button');
      btn2.innerText = e.options[1];
      btn2.style.margin = '5px';
      btn2.onclick = () => {
        affection += e.effects[1];
        hunger += 2;
        cleanupEvent(container);
      };

      container.appendChild(text);
      container.appendChild(btn1);
      container.appendChild(btn2);
      document.body.appendChild(container);

      function cleanupEvent(box) {
        if (affection > 100) affection = 100;
        if (affection < 0) affection = 0;
        if (hunger > 100) hunger = 100;
        if (hunger < 0) hunger = 0;
        document.getElementById('affection').innerText = affection;
        document.getElementById('hunger').innerText = hunger;
        document.body.removeChild(box);
        inEvent = false;
        eventCountdown = 5;
        document.getElementById('countdown').innerText = eventCountdown;
        countdownInterval = setInterval(() => {
          if (!inEvent && age < 12) {
            eventCountdown--;
            if (eventCountdown <= 0) eventCountdown = 5;
            document.getElementById('countdown').innerText = eventCountdown;
          }
        }, 1000);
      }
    }

    // ê²Œì„ ì¢…ë£Œ í•¨ìˆ˜
    function endGame() {
      clearInterval(ageInterval);
      clearInterval(eventInterval);
      clearInterval(countdownInterval);
      document.getElementById('album-img').src = document.getElementById('dogImage').src;
      let endMessage = `${dogName}ê°€ ì˜ˆì˜ê³  ë©‹ì§€ê²Œ ìëì–´ìš”!`;
      if(affection > 80) {
        endMessage += ` ë‹¹ì‹ ì€ ìµœê³ ì˜ ì£¼ì¸ì´ì—ìš”!`;
      } else if (affection < 40) {
        endMessage += ` ì¡°ê¸ˆ ë” ê´€ì‹¬ì´ í•„ìš”í•´ ë³´ì—¬ìš”.`;
      }
      document.getElementById('albumText').innerText = endMessage;
      switchScreen('album-screen');
    }
  </script>
</body>
</html>
ï¿½
